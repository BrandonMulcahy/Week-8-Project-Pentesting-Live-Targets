# Project 8 - Pentesting Live Targets

Time spent: 3.5 hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

###Vulnerability #1: SQLi

By navigating to a salesperson site and supplying the empty string as the id parameter, we receive an error message stating that the database query failed. This indicates that this site is vulnerable to SQLi. This could lead to exports of additional data, if a tool like SQLmap were used to enumerate the tables in the database. This point of entry could potentially expose the entire database to an attacker.

![My image](https://raw.githubusercontent.com/BrandonMulcahy/Week-8-Project-Pentesting-Live-Targets/master/Blue1.gif)

###Vulnerability #2: Session Hijacking
Using the supplied script at public/hacktools/change_session_id.php, we can exploit the fact that the site is vulnerable to session hihacking by taking the session ID from a good session, and using it to log in to the same site in a new, unauthenticated private window in FireFox where credentials have not been entered.

![My image](https://raw.githubusercontent.com/BrandonMulcahy/Week-8-Project-Pentesting-Live-Targets/master/Blue2.gif)

## Green

###Vulnerability #1: XSS Redirect

The feedback system has little protection against XSS attacks. I supplied <body onload="window.location = 'http://i.ytimg.com/vi/0vxCFIGCqnI/maxresdefault.jpg'"> in the feedback comment box. On the admin side, this javascript I specified for the onload handler is loaded (with no filtering), causing the browser window to be redirected to the URL specified.  The result is, once my feedback item loaded on the admin side, after some alerts left by other hackers, the admin is redirected to an image informing them that they have been hacked.
  
![My image](https://raw.githubusercontent.com/BrandonMulcahy/Week-8-Project-Pentesting-Live-Targets/master/Green1.gif)

###Vulnerability #2: Username Enumeration
The login page for the green site applies CSS class "failure" to the "Log in was unsuccessful" span tag when a good username is entered with a bad password, but applies the class "failed" to the same span tag when a bad username is supplied. Failure simply applies bold formatting to the text. Faliure applies no formatting. This can be used to brute force a list of good usernames, especially if the hacker has access to a company directory and understands the username scheme the company employs. Common schemes that might be tried for a user named Bob Testerson: might be btesterson, testersonb, bobt, bob.testerson, etc.

This exploit method, combined with a tool like Intruder in Burp Suite, would enable a hacker to enumerate all valid usernames, given enough time.

![My image](https://raw.githubusercontent.com/BrandonMulcahy/Week-8-Project-Pentesting-Live-Targets/master/Green2.gif)

## Red

###Vulnerability #1: IDOR

Using Burp, we can iterate through the sales staff users using the predictable IDs in the url of each sales person, as each is referenced in a sequential manner. Having the intruder tool in Burp Suite automate the replacement of the user ID number in the URL, we see that sales IDs 10 and 11, not referenced by a link on the sales rep page, are indeed still accessible because of the IDORs made by the site. 

![My image](https://raw.githubusercontent.com/BrandonMulcahy/Week-8-Project-Pentesting-Live-Targets/master/Red1.gif)

###Vulnerability #2: CSRF

There is no protection against CSRF for updating sales team members. I was able to design a page that changed Robert Hamilton to Kevin Mitnick. 

![My image](https://raw.githubusercontent.com/BrandonMulcahy/Week-8-Project-Pentesting-Live-Targets/master/Red2.gif)

## Notes
CSRF would have been easier if I had access to an outside web server, but I need to reset my ftp credentials for my personal site.
